 <!doctype html> <html lang="zh" class="no-js"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width,initial-scale=1"> <meta name="description" content="Programming Tech Sharing æ˜¯æˆ‘ç”¨æ¥æ•´åˆçŸ¥è¯†çš„ä¸€ä¸ªç«™ç‚¹ï¼Œä¸»è¦é¢å‘ç¼–ç¨‹çŸ¥è¯†ã€‚"> <meta name="author" content="Torres Lei"> <link rel="canonical" href="https://yongqilei.github.io/java/jvm-breakdown/"> <link rel="icon" href="../../favicon.ico"> <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.1.4"> <title>JVM Inteview - Programming Tech Sharing</title> <link rel="stylesheet" href="../../assets/stylesheets/main.bb3983ee.min.css"> <link rel="stylesheet" href="../../assets/stylesheets/palette.e6a45f82.min.css"> <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin> <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Sans:300,400,400i,700%7CFira+Mono&display=fallback"> <style>:root{--md-text-font:"Fira Sans";--md-code-font:"Fira Mono"}</style> <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script> </head> <body dir="ltr" data-md-color-scheme="" data-md-color-primary="indigo" data-md-color-accent="indigo"> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)</script> <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off"> <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off"> <label class="md-overlay" for="__drawer"></label> <div data-md-component="skip"> <a href="#purpose" class="md-skip"> è·³è½¬è‡³ </a> </div> <div data-md-component="announce"> </div> <header class="md-header" data-md-component="header"> <nav class="md-header__inner md-grid" aria-label="é¡µçœ‰"> <a href="../.." title="Programming Tech Sharing" class="md-header__button md-logo" aria-label="Programming Tech Sharing" data-md-component="logo"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6 20h7v2H6c-1.11 0-2-.89-2-2V4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8.54l-1.5-.82-.5.28V4h-5v8l-2.5-2.25L8 12V4H6v16m18-3-5.5-3-5.5 3 5.5 3 5.5-3m-9 2.09v2L18.5 23l3.5-1.91v-2L18.5 21 15 19.09z"/></svg> </a> <label class="md-header__button md-icon" for="__drawer"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class="md-header__title" data-md-component="header-title"> <div class="md-header__ellipsis"> <div class="md-header__topic"> <span class="md-ellipsis"> Programming Tech Sharing </span> </div> <div class="md-header__topic" data-md-component="header-topic"> <span class="md-ellipsis"> JVM Inteview </span> </div> </div> </div> <form class="md-header__option" data-md-component="palette"> <input class="md-option" data-md-color-media="" data-md-color-scheme="" data-md-color-primary="indigo" data-md-color-accent="indigo" aria-label="Switch to dark mode" type="radio" name="__palette" id="__palette_1"> <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3z"/></svg> </label> <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="red" data-md-color-accent="red" aria-label="Switch to light mode" type="radio" name="__palette" id="__palette_2"> <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg> </label> </form> <label class="md-header__button md-icon" for="__search"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class="md-search" data-md-component="search" role="dialog"> <label class="md-search__overlay" for="__search"></label> <div class="md-search__inner" role="search"> <form class="md-search__form" name="search"> <input class="md-search__input" name="query" aria-label="æœç´¢" placeholder="æœç´¢" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required> <label class="md-search__icon md-icon" for="__search"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <nav class="md-search__options" aria-label="æŸ¥æ‰¾"> <a href="javascript:void(0)" class="md-search__icon md-icon" aria-label="åˆ†äº«" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08z"/></svg> </a> <button type="reset" class="md-search__icon md-icon" aria-label="æ¸…ç©ºå½“å‰å†…å®¹" tabindex="-1"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </nav> <div class="md-search__suggest" data-md-component="search-suggest"></div> </form> <div class="md-search__output"> <div class="md-search__scrollwrap" data-md-scrollfix> <div class="md-search-result" data-md-component="search-result"> <div class="md-search-result__meta"> æ­£åœ¨åˆå§‹åŒ–æœç´¢å¼•æ“ </div> <ol class="md-search-result__list"></ol> </div> </div> </div> </div> </div> <div class="md-header__source"> <a href="https://github.com/yongqilei/yongqilei.github.io" title="å‰å¾€ä»“åº“" class="md-source" data-md-component="source"> <div class="md-source__icon md-icon"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg> </div> <div class="md-source__repository"> Programming Space </div> </a> </div> </nav> </header> <div class="md-container" data-md-component="container"> <nav class="md-tabs" aria-label="æ ‡ç­¾" data-md-component="tabs"> <div class="md-tabs__inner md-grid"> <ul class="md-tabs__list"> <li class="md-tabs__item"> <a href="../.." class="md-tabs__link"> ç®€ä»‹ </a> </li> <li class="md-tabs__item"> <a href="../" class="md-tabs__link md-tabs__link--active"> Java </a> </li> <li class="md-tabs__item"> <a href="../../cloud/" class="md-tabs__link"> äº‘åŸç”Ÿ </a> </li> <li class="md-tabs__item"> <a href="../../algo/leetcode/" class="md-tabs__link"> ç®—æ³• </a> </li> <li class="md-tabs__item"> <a href="../../bigdata/" class="md-tabs__link"> å¤§æ•°æ® </a> </li> </ul> </div> </nav> <main class="md-main" data-md-component="main"> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label="å¯¼èˆªæ " data-md-level="0"> <label class="md-nav__title" for="__drawer"> <a href="../.." title="Programming Tech Sharing" class="md-nav__button md-logo" aria-label="Programming Tech Sharing" data-md-component="logo"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6 20h7v2H6c-1.11 0-2-.89-2-2V4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8.54l-1.5-.82-.5.28V4h-5v8l-2.5-2.25L8 12V4H6v16m18-3-5.5-3-5.5 3 5.5 3 5.5-3m-9 2.09v2L18.5 23l3.5-1.91v-2L18.5 21 15 19.09z"/></svg> </a> Programming Tech Sharing </label> <div class="md-nav__source"> <a href="https://github.com/yongqilei/yongqilei.github.io" title="å‰å¾€ä»“åº“" class="md-source" data-md-component="source"> <div class="md-source__icon md-icon"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg> </div> <div class="md-source__repository"> Programming Space </div> </a> </div> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1"> <label class="md-nav__link" for="__nav_1"> ç®€ä»‹ <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="ç®€ä»‹" data-md-level="1"> <label class="md-nav__title" for="__nav_1"> <span class="md-nav__icon md-icon"></span> ç®€ä»‹ </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../.." class="md-nav__link"> Getting Started </a> </li> <li class="md-nav__item"> <a href="../../about/" class="md-nav__link"> å…³äºæˆ‘ </a> </li> <li class="md-nav__item"> <a href="../../about-en/" class="md-nav__link"> About Me </a> </li> <li class="md-nav__item"> <a href="../../tags/" class="md-nav__link"> æ ‡ç­¾ </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked="checked"> <label class="md-nav__link" for="__nav_2"> Java <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="Java" data-md-level="1"> <label class="md-nav__title" for="__nav_2"> <span class="md-nav__icon md-icon"></span> Java </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../" class="md-nav__link"> Javaç®€ä»‹ </a> </li> <li class="md-nav__item"> <a href="../synchronized/" class="md-nav__link"> Synchronized å­¦ä¹ ç¬”è®° </a> </li> <li class="md-nav__item"> <a href="../volatile/" class="md-nav__link"> Volatile å­¦ä¹ ç¬”è®° </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_4" type="checkbox" id="__nav_2_4" checked="checked"> <label class="md-nav__link" for="__nav_2_4"> JVM <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="JVM" data-md-level="2"> <label class="md-nav__title" for="__nav_2_4"> <span class="md-nav__icon md-icon"></span> JVM </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../garbage-collector/" class="md-nav__link"> Java åƒåœ¾æ”¶é›†å™¨ </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc"> <label class="md-nav__link md-nav__link--active" for="__toc"> JVM å†…å­˜åŒºåŸŸå­¦ä¹ ç¬”è®° <span class="md-nav__icon md-icon"></span> </label> <a href="./" class="md-nav__link md-nav__link--active"> JVM å†…å­˜åŒºåŸŸå­¦ä¹ ç¬”è®° </a> <nav class="md-nav md-nav--secondary" aria-label="ç›®å½•"> <label class="md-nav__title" for="__toc"> <span class="md-nav__icon md-icon"></span> ç›®å½• </label> <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix> <li class="md-nav__item"> <a href="#purpose" class="md-nav__link"> Purpose </a> </li> <li class="md-nav__item"> <a href="#java-7-java-8" class="md-nav__link"> Java 7 åˆ° Java 8 çš„æ›´æ–° </a> </li> <li class="md-nav__item"> <a href="#java" class="md-nav__link"> Java è™šæ‹Ÿæœºå†…å­˜åŒºåŸŸ </a> </li> <li class="md-nav__item"> <a href="#run-time-data-areas-" class="md-nav__link"> Run-Time Data Areas - è¿è¡Œæ—¶æ•°æ®åŒº </a> <nav class="md-nav" aria-label="Run-Time Data Areas - è¿è¡Œæ—¶æ•°æ®åŒº"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#the-pc-register-" class="md-nav__link"> The PC Register - ç¨‹åºè®¡æ•°å™¨å¯„å­˜å™¨ </a> </li> <li class="md-nav__item"> <a href="#java-virtual-machine-stacks-jvm" class="md-nav__link"> Java Virtual Machine Stacks - JVM æ ˆ </a> </li> <li class="md-nav__item"> <a href="#heap-" class="md-nav__link"> Heap - å † </a> </li> <li class="md-nav__item"> <a href="#method-area-java-8" class="md-nav__link"> Method Area - æ–¹æ³•åŒºï¼ˆJava 8 ä¹‹åå·²ç»ç§»é™¤ï¼‰ </a> </li> <li class="md-nav__item"> <a href="#run-time-constant-pool-" class="md-nav__link"> Run-Time Constant Pool - è¿è¡Œæ—¶å¸¸é‡æ±  </a> </li> <li class="md-nav__item"> <a href="#native-method-stacks-" class="md-nav__link"> Native Method Stacks - æœ¬åœ°æ–¹æ³•æ ˆ </a> </li> <li class="md-nav__item"> <a href="#metaspace" class="md-nav__link"> Metaspace </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#metaspace-" class="md-nav__link"> Metaspace - å…ƒç©ºé—´ </a> </li> <li class="md-nav__item"> <a href="#frames-" class="md-nav__link"> Frames - æ ˆå¸§ </a> <nav class="md-nav" aria-label="Frames - æ ˆå¸§"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#local-variables-" class="md-nav__link"> Local Variables - æœ¬åœ°å˜é‡ </a> </li> <li class="md-nav__item"> <a href="#operand-stacks-" class="md-nav__link"> Operand Stacks - æ“ä½œæ•°æ ˆ </a> </li> <li class="md-nav__item"> <a href="#dynamic-linking-" class="md-nav__link"> Dynamic Linking - åŠ¨æ€é“¾æ¥ </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#conclusion" class="md-nav__link"> Conclusion </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_5" type="checkbox" id="__nav_2_5"> <label class="md-nav__link" for="__nav_2_5"> Spring <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="Spring" data-md-level="2"> <label class="md-nav__title" for="__nav_2_5"> <span class="md-nav__icon md-icon"></span> Spring </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../spring-cloud-ribbon/" class="md-nav__link"> Spring Cloud Ribbon </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_6" type="checkbox" id="__nav_2_6"> <label class="md-nav__link" for="__nav_2_6"> é¢è¯• <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="é¢è¯•" data-md-level="2"> <label class="md-nav__title" for="__nav_2_6"> <span class="md-nav__icon md-icon"></span> é¢è¯• </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../interview/bytedance-interview/" class="md-nav__link"> å­—èŠ‚è·³åŠ¨ Java é¢è¯•é¢˜ </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3"> <label class="md-nav__link" for="__nav_3"> äº‘åŸç”Ÿ <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="äº‘åŸç”Ÿ" data-md-level="1"> <label class="md-nav__title" for="__nav_3"> <span class="md-nav__icon md-icon"></span> äº‘åŸç”Ÿ </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../cloud/" class="md-nav__link"> äº‘åŸç”Ÿç®€ä»‹ </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2" type="checkbox" id="__nav_3_2"> <label class="md-nav__link" for="__nav_3_2"> Golang <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="Golang" data-md-level="2"> <label class="md-nav__title" for="__nav_3_2"> <span class="md-nav__icon md-icon"></span> Golang </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../cloud/golang-basics/" class="md-nav__link"> GolangåŸºç¡€çŸ¥è¯† </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3" type="checkbox" id="__nav_3_3"> <label class="md-nav__link" for="__nav_3_3"> Kubernetes <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="Kubernetes" data-md-level="2"> <label class="md-nav__title" for="__nav_3_3"> <span class="md-nav__icon md-icon"></span> Kubernetes </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../cloud/kubernetes-on-centos/" class="md-nav__link"> Kubernetes on CentOS </a> </li> <li class="md-nav__item"> <a href="../../cloud/kubernetes-installation-on-centos/" class="md-nav__link"> åœ¨CentOSä¸Šå®‰è£…K8S </a> </li> <li class="md-nav__item"> <a href="../../cloud/kubernetes-java-commands/" class="md-nav__link"> Kubernetesä¸­Javaåº”ç”¨ç›¸å…³æ“ä½œ </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4"> <label class="md-nav__link" for="__nav_4"> ç®—æ³• <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="ç®—æ³•" data-md-level="1"> <label class="md-nav__title" for="__nav_4"> <span class="md-nav__icon md-icon"></span> ç®—æ³• </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../algo/leetcode/" class="md-nav__link"> Leetcodeåˆ·é¢˜è®°å½• </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" type="checkbox" id="__nav_4_2"> <label class="md-nav__link" for="__nav_4_2"> LeetCode <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="LeetCode" data-md-level="2"> <label class="md-nav__title" for="__nav_4_2"> <span class="md-nav__icon md-icon"></span> LeetCode </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2_1" type="checkbox" id="__nav_4_2_1"> <label class="md-nav__link" for="__nav_4_2_1"> Daily <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="Daily" data-md-level="3"> <label class="md-nav__title" for="__nav_4_2_1"> <span class="md-nav__icon md-icon"></span> Daily </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../algo/leetcode/daily/2022-01-04/" class="md-nav__link"> 2022/01/04 - 913. çŒ«å’Œè€é¼  </a> </li> <li class="md-nav__item"> <a href="../../algo/leetcode/daily/2022-01-05/" class="md-nav__link"> 2021/01/05 - 1576. æ›¿æ¢æ‰€æœ‰çš„é—®å· </a> </li> <li class="md-nav__item"> <a href="../../algo/leetcode/daily/2022-01-07/" class="md-nav__link"> 2022/01/07 - 1614. æ‹¬å·çš„æœ€å¤§åµŒå¥—æ·±åº¦ </a> </li> <li class="md-nav__item"> <a href="../../algo/leetcode/daily/2022-01-07-en/" class="md-nav__link"> 2022/01/07 - 382. Linked List Random Node </a> </li> <li class="md-nav__item"> <a href="../../algo/leetcode/daily/2022-01-08/" class="md-nav__link"> 2022/01/08 - 89. æ ¼é›·ç¼–ç  </a> </li> <li class="md-nav__item"> <a href="../../algo/leetcode/daily/2022-01-09-en/" class="md-nav__link"> 2022/01/09 - 1041. Robot Bounded In Circle </a> </li> <li class="md-nav__item"> <a href="../../algo/leetcode/daily/2022-01-09/" class="md-nav__link"> 2022/01/09 - 1629. æŒ‰é”®æŒç»­æ—¶é—´æœ€é•¿çš„é”® </a> </li> <li class="md-nav__item"> <a href="../../algo/leetcode/daily/2022-01-10/" class="md-nav__link"> 2022/01/10 - 306. ç´¯åŠ æ•° </a> </li> <li class="md-nav__item"> <a href="../../algo/leetcode/daily/2022-01-11/" class="md-nav__link"> 2022/01/11 - 1036. é€ƒç¦»å¤§è¿·å®« </a> </li> <li class="md-nav__item"> <a href="../../algo/leetcode/daily/2022-01-12-en/" class="md-nav__link"> 2022/01/12 - 701. Insert into a Binary Search Tree </a> </li> <li class="md-nav__item"> <a href="../../algo/leetcode/daily/2022-01-13/" class="md-nav__link"> 2022/01/13 - 747. è‡³å°‘æ˜¯å…¶ä»–æ•°å­—ä¸¤å€çš„æœ€å¤§æ•° </a> </li> <li class="md-nav__item"> <a href="../../algo/leetcode/daily/2022-01-14/" class="md-nav__link"> 2022/01/14 - 373. æŸ¥æ‰¾å’Œæœ€å°çš„ K å¯¹æ•°å­— </a> </li> <li class="md-nav__item"> <a href="../../algo/leetcode/daily/2022-01-15-en/" class="md-nav__link"> 2022/01/15 - 1345. Jump Game IV </a> </li> <li class="md-nav__item"> <a href="../../algo/leetcode/daily/2022-01-15/" class="md-nav__link"> 2022/01/15 - 1716. è®¡ç®—åŠ›æ‰£é“¶è¡Œçš„é’± </a> </li> <li class="md-nav__item"> <a href="../../algo/leetcode/daily/2022-01-16/" class="md-nav__link"> 2022/01/16 - 849. Maximize Distance to Closest Person </a> </li> <li class="md-nav__item"> <a href="../../algo/leetcode/daily/2022-01-17/" class="md-nav__link"> 2022/01/17 - 290. Word Pattern </a> </li> <li class="md-nav__item"> <a href="../../algo/leetcode/daily/2022-01-20/" class="md-nav__link"> 2022/01/20 - 875. Koko Eating Bananas </a> </li> <li class="md-nav__item"> <a href="../../algo/leetcode/daily/2022-01-21/" class="md-nav__link"> 2022/01/20 - 134. Gas Station </a> </li> <li class="md-nav__item"> <a href="../../algo/leetcode/daily/2022-01-26/" class="md-nav__link"> 2022/01/26 - 1305. All Elements in Two Binary Search Trees </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2_2" type="checkbox" id="__nav_4_2_2"> <label class="md-nav__link" for="__nav_4_2_2"> åŠ¨æ€è§„åˆ’ <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="åŠ¨æ€è§„åˆ’" data-md-level="3"> <label class="md-nav__title" for="__nav_4_2_2"> <span class="md-nav__icon md-icon"></span> åŠ¨æ€è§„åˆ’ </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../algo/leetcode/dp/188-best-time-to-buy-and-sell-stock-iv/" class="md-nav__link"> 188. ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº IV </a> </li> <li class="md-nav__item"> <a href="../../algo/leetcode/dp/309-best-time-to-buy-and-sell-stock-with-cooldown/" class="md-nav__link"> 309. æœ€ä½³ä¹°å–è‚¡ç¥¨æ—¶æœºå«å†·å†»æœŸ </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2_3" type="checkbox" id="__nav_4_2_3"> <label class="md-nav__link" for="__nav_4_2_3"> å­—ç¬¦ä¸²ç³»åˆ— <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="å­—ç¬¦ä¸²ç³»åˆ—" data-md-level="3"> <label class="md-nav__title" for="__nav_4_2_3"> <span class="md-nav__icon md-icon"></span> å­—ç¬¦ä¸²ç³»åˆ— </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../algo/leetcode/string/string-to-integer-atoi/" class="md-nav__link"> 8. String to Integer (atoi) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2_4" type="checkbox" id="__nav_4_2_4"> <label class="md-nav__link" for="__nav_4_2_4"> æ ‘ç³»åˆ— <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="æ ‘ç³»åˆ—" data-md-level="3"> <label class="md-nav__title" for="__nav_4_2_4"> <span class="md-nav__icon md-icon"></span> æ ‘ç³»åˆ— </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../algo/leetcode/tree/98-validate-binary-search-tree/" class="md-nav__link"> 98. Validate Binary Search Tree </a> </li> <li class="md-nav__item"> <a href="../../algo/leetcode/tree/102-binary-tree-level-order-traversal/" class="md-nav__link"> 102. Binary Tree Level Order Traversal </a> </li> <li class="md-nav__item"> <a href="../../algo/leetcode/tree/103-binary-tree-zigzag-level-order-traversal/" class="md-nav__link"> 103. Binary Tree Zigzag Level Order Traversal </a> </li> <li class="md-nav__item"> <a href="../../algo/leetcode/tree/107-binary-tree-level-order-traversal-ii/" class="md-nav__link"> 107. Binary Tree Level Order Traversal II </a> </li> <li class="md-nav__item"> <a href="../../algo/leetcode/tree/701-insert-into-a-binary-search-tree/" class="md-nav__link"> 701. Insert into a Binary Search Tree </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2_5" type="checkbox" id="__nav_4_2_5"> <label class="md-nav__link" for="__nav_4_2_5"> äºŒåˆ†æŸ¥æ‰¾ç³»åˆ— <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="äºŒåˆ†æŸ¥æ‰¾ç³»åˆ—" data-md-level="3"> <label class="md-nav__title" for="__nav_4_2_5"> <span class="md-nav__icon md-icon"></span> äºŒåˆ†æŸ¥æ‰¾ç³»åˆ— </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../algo/leetcode/binary-search/33-search-in-rotated-sorted-array/" class="md-nav__link"> 33. Search in Rotated Sorted Array </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2_6" type="checkbox" id="__nav_4_2_6"> <label class="md-nav__link" for="__nav_4_2_6"> å›æº¯ç³»åˆ— <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="å›æº¯ç³»åˆ—" data-md-level="3"> <label class="md-nav__title" for="__nav_4_2_6"> <span class="md-nav__icon md-icon"></span> å›æº¯ç³»åˆ— </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../algo/leetcode/backtrack/22-generate-parentheses/" class="md-nav__link"> 22. Generate Parentheses </a> </li> <li class="md-nav__item"> <a href="../../algo/leetcode/backtrack/17-letter-combination-of-a-phone-number/" class="md-nav__link"> 17. Letter Combinations of a Phone Number </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../../algo/leetcode/number-of-islands/" class="md-nav__link"> 200. å²›å±¿æ•°é‡ </a> </li> <li class="md-nav__item"> <a href="../../algo/leetcode/check-completeness-of-a-binary-tree/" class="md-nav__link"> 958. Check Completeness of a Binary Tree </a> </li> <li class="md-nav__item"> <a href="../../algo/leetcode/rotate-image-48/" class="md-nav__link"> 48. Rotate Image </a> </li> <li class="md-nav__item"> <a href="../../algo/leetcode/142-linked-list-cycle-ii/" class="md-nav__link"> 142. Linked List Cycle II </a> </li> <li class="md-nav__item"> <a href="../../algo/leetcode/string/6-zigzag-conversion/" class="md-nav__link"> 6. Zigzag Conversion </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../../algo/union-find/" class="md-nav__link"> å¹¶æŸ¥é›† </a> </li> <li class="md-nav__item"> <a href="../../algo/manacher-palindrome/" class="md-nav__link"> Manacherç®—æ³• </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_5" type="checkbox" id="__nav_4_5"> <label class="md-nav__link" for="__nav_4_5"> æ’åºç®—æ³• <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="æ’åºç®—æ³•" data-md-level="2"> <label class="md-nav__title" for="__nav_4_5"> <span class="md-nav__icon md-icon"></span> æ’åºç®—æ³• </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../algo/selection-sort/" class="md-nav__link"> é€‰æ‹©æ’åº </a> </li> <li class="md-nav__item"> <a href="../../algo/insertion-sort/" class="md-nav__link"> æ’å…¥æ’åº </a> </li> <li class="md-nav__item"> <a href="../../algo/shell-sort/" class="md-nav__link"> å¸Œå°”æ’åº </a> </li> <li class="md-nav__item"> <a href="../../algo/merge-sort/" class="md-nav__link"> å½’å¹¶æ’åº </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../../algo/rabin-karp-algo/" class="md-nav__link"> Rabin Karp Algorithm - å­—ç¬¦ä¸²å“ˆå¸Œç®—æ³• </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5"> <label class="md-nav__link" for="__nav_5"> å¤§æ•°æ® <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="å¤§æ•°æ®" data-md-level="1"> <label class="md-nav__title" for="__nav_5"> <span class="md-nav__icon md-icon"></span> å¤§æ•°æ® </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../bigdata/" class="md-nav__link"> ç®€ä»‹ </a> </li> <li class="md-nav__item"> <a href="../../bigdata/scala-basics/" class="md-nav__link"> Scala åŸºç¡€çŸ¥è¯†å­¦ä¹ ç¬”è®° </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav class="md-nav md-nav--secondary" aria-label="ç›®å½•"> <label class="md-nav__title" for="__toc"> <span class="md-nav__icon md-icon"></span> ç›®å½• </label> <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix> <li class="md-nav__item"> <a href="#purpose" class="md-nav__link"> Purpose </a> </li> <li class="md-nav__item"> <a href="#java-7-java-8" class="md-nav__link"> Java 7 åˆ° Java 8 çš„æ›´æ–° </a> </li> <li class="md-nav__item"> <a href="#java" class="md-nav__link"> Java è™šæ‹Ÿæœºå†…å­˜åŒºåŸŸ </a> </li> <li class="md-nav__item"> <a href="#run-time-data-areas-" class="md-nav__link"> Run-Time Data Areas - è¿è¡Œæ—¶æ•°æ®åŒº </a> <nav class="md-nav" aria-label="Run-Time Data Areas - è¿è¡Œæ—¶æ•°æ®åŒº"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#the-pc-register-" class="md-nav__link"> The PC Register - ç¨‹åºè®¡æ•°å™¨å¯„å­˜å™¨ </a> </li> <li class="md-nav__item"> <a href="#java-virtual-machine-stacks-jvm" class="md-nav__link"> Java Virtual Machine Stacks - JVM æ ˆ </a> </li> <li class="md-nav__item"> <a href="#heap-" class="md-nav__link"> Heap - å † </a> </li> <li class="md-nav__item"> <a href="#method-area-java-8" class="md-nav__link"> Method Area - æ–¹æ³•åŒºï¼ˆJava 8 ä¹‹åå·²ç»ç§»é™¤ï¼‰ </a> </li> <li class="md-nav__item"> <a href="#run-time-constant-pool-" class="md-nav__link"> Run-Time Constant Pool - è¿è¡Œæ—¶å¸¸é‡æ±  </a> </li> <li class="md-nav__item"> <a href="#native-method-stacks-" class="md-nav__link"> Native Method Stacks - æœ¬åœ°æ–¹æ³•æ ˆ </a> </li> <li class="md-nav__item"> <a href="#metaspace" class="md-nav__link"> Metaspace </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#metaspace-" class="md-nav__link"> Metaspace - å…ƒç©ºé—´ </a> </li> <li class="md-nav__item"> <a href="#frames-" class="md-nav__link"> Frames - æ ˆå¸§ </a> <nav class="md-nav" aria-label="Frames - æ ˆå¸§"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#local-variables-" class="md-nav__link"> Local Variables - æœ¬åœ°å˜é‡ </a> </li> <li class="md-nav__item"> <a href="#operand-stacks-" class="md-nav__link"> Operand Stacks - æ“ä½œæ•°æ ˆ </a> </li> <li class="md-nav__item"> <a href="#dynamic-linking-" class="md-nav__link"> Dynamic Linking - åŠ¨æ€é“¾æ¥ </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#conclusion" class="md-nav__link"> Conclusion </a> </li> </ul> </nav> </div> </div> </div> <div class="md-content" data-md-component="content"> <article class="md-content__inner md-typeset"> <a href="https://github.com/yongqilei/yongqilei.github.io/edit/master/docs/java/jvm-breakdown.md" title="ç¼–è¾‘æ­¤é¡µ" class="md-content__button md-icon"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg> </a> <h1>JVM å†…å­˜åŒºåŸŸå­¦ä¹ ç¬”è®°</h1> <h2 id="purpose">Purpose<a class="headerlink" href="#purpose" title="Permanent link">&para;</a></h2> <p>è¿™ç¯‡æ–‡ç« æ˜¯ç”¨æ¥è®°å½• Java é¢è¯•æ—¶éœ€è¦åº”å¯¹çš„ Java è™šæ‹Ÿæœºéƒ¨åˆ†çš„é—®é¢˜ã€‚</p> <h2 id="java-7-java-8">Java 7 åˆ° Java 8 çš„æ›´æ–°<a class="headerlink" href="#java-7-java-8" title="Permanent link">&para;</a></h2> <p><a href="http://openjdk.java.net/jeps/122">JEP 122: Remove the Permanent Generation</a></p> <p>åœ¨æ­¤æ–‡ç« ä¸­å‡ºç°äº†è¿™æ®µè¯ï¼š</p> <div class="admonition info"> <p class="admonition-title">Info</p> <p>The proposed implementation will allocate class meta-data in native memory and move interned Strings and class statics to the Java heap. Hotspot will explicitly allocate and free the native memory for the class meta-data.</p> </div> <p>è¿™æ¬¡æå‡ºçš„å®ç°ä¼šå°†ç±»çš„å…ƒæ•°æ®åˆ†é…åœ¨æœ¬åœ°å†…å­˜ä¸­ï¼Œå¹¶å°† interned Strings å’Œç±»é™æ€æ•°æ®ç§»å…¥ Java å †ä¸­ã€‚</p> <p>ä¹‹å‰ä½¿ç”¨ <code>-XX:MaxPermSize</code> æ¥æ§åˆ¶ Permanent Generation çš„å†…å­˜å¤§å°ï¼Œç°åœ¨å¯ä»¥ä½¿ç”¨ <code>-XX:MaxMetaspaceSize</code> æ§åˆ¶å…ƒç©ºé—´çš„æœ€å¤§å€¼äº†ã€‚</p> <h2 id="java">Java è™šæ‹Ÿæœºå†…å­˜åŒºåŸŸ<a class="headerlink" href="#java" title="Permanent link">&para;</a></h2> <p>Java 7 å’Œ Java 8 æœ‰ä¸¤ç§ä¸åŒçš„å†…å­˜åŒºåŸŸï¼Œæˆ‘ä¼šå°†ä»–ä»¬åˆ†å¼€è¯´æ˜ã€‚</p> <p><img alt="JVM Memory Area" src="../images/jvm/jvm-memory-area.png"></p> <p>JVM å†…å­˜åŒºåŸŸä¸­è¿˜æœ‰ä¸€ä¸ªç‰¹æ®Šçš„éƒ¨åˆ†ï¼Œå«åš Code Cache (ä»£ç ç¼“å­˜)ï¼Œcode cache æ˜¯ JVM ç”¨æ¥å­˜å‚¨ native codeã€‚å®ƒæ˜¯ä½äºè¿ç»­å†…å­˜å—å—ä¸Šçš„å•ä¸ªå †æ•°æ®ç»“æ„ã€‚</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>è¿™ä¸ªå°±æ¶‰åŠåˆ° Tiered Compilation äº†ï¼Œå¯ä»¥è‡ªè¡Œå»çœ‹æ–‡æ¡£ï¼š<a href="https://docs.oracle.com/en/java/javase/11/vm/java-hotspot-virtual-machine-performance-enhancements.html">Java Virtual Machine Guide </a></p> </div> <h2 id="run-time-data-areas-">Run-Time Data Areas - è¿è¡Œæ—¶æ•°æ®åŒº<a class="headerlink" href="#run-time-data-areas-" title="Permanent link">&para;</a></h2> <p>JVM å®šä¹‰äº†å„ç§å„æ ·åœ¨ç¨‹åºæ‰§è¡Œä¸­ä½¿ç”¨çš„è¿è¡Œæ—¶æ•°æ®åŒºã€‚ä¸€äº›æ˜¯åœ¨ JVM å¯åŠ¨æ—¶åˆ›å»ºå¹¶ä¸”åªåœ¨ JVM å…³é—­æ—¶é”€æ¯ï¼Œå¦å¤–ä¸€äº›åˆ™æ˜¯æ ¹æ®æ¯ä¸ªçº¿ç¨‹ï¼Œçº¿ç¨‹çš„æ•°æ®åŒºæ˜¯åœ¨çº¿ç¨‹åˆ›å»ºæ—¶åˆ›å»ºå¹¶åœ¨çº¿ç¨‹æ‰§è¡Œå®Œæ¯•æ—¶é”€æ¯ã€‚</p> <h3 id="the-pc-register-">The PC Register - ç¨‹åºè®¡æ•°å™¨å¯„å­˜å™¨<a class="headerlink" href="#the-pc-register-" title="Permanent link">&para;</a></h3> <div class="admonition tip"> <p class="admonition-title">Tip</p> <p>pc stands for program counter, so pc register equals to program counter register. ä¸‹æ–‡éƒ½å°†ç®€ç§° pc register ä¸º ç¨‹åºè®¡æ•°å™¨</p> </div> <p>JVM æ”¯æŒåŒä¸€æ—¶é—´è®¸å¤šçº¿ç¨‹çš„æ‰§è¡Œã€‚æ¯ä¸ª JVM çº¿ç¨‹éƒ½æœ‰å®ƒè‡ªå·±çš„ pc æ³¨å†Œå™¨ã€‚ä»»ä½•æ—¶é—´ç‚¹çº¿ç¨‹éƒ½åœ¨æ‰§è¡Œå•ä¸ªæ–¹æ³•çš„ä»£ç ï¼Œå¦‚æœè¿™ä¸ªæ–¹æ³•ä¸æ˜¯ native æ–¹æ³•ï¼Œåˆ™å½“å‰çº¿ç¨‹çš„ç¨‹åºè®¡æ•°å™¨åŒ…å«ç°åœ¨æ­£åœ¨æ‰§è¡Œçš„ JVM æŒ‡ä»¤çš„åœ°å€ã€‚ è€Œå¦‚æœæ­£åœ¨æ‰§è¡Œ native æ–¹æ³•ï¼Œåˆ™è¯¥çº¿ç¨‹çš„ç¨‹åºè®¡æ•°å™¨çš„å€¼å°±æ˜¯ undefinedã€‚ï¼ˆç¨‹åºè®¡æ•°å™¨è¶³ä»¥ä¿å­˜ç‰¹å®šå¹³å°ä¸Šçš„ returnAddress æˆ– native æŒ‡é’ˆã€‚ï¼‰</p> <h3 id="java-virtual-machine-stacks-jvm">Java Virtual Machine Stacks - JVM æ ˆ<a class="headerlink" href="#java-virtual-machine-stacks-jvm" title="Permanent link">&para;</a></h3> <p>æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰ä¸ªç§æœ‰çš„æ ˆç©ºé—´ï¼Œåœ¨çº¿ç¨‹åˆ›å»ºæ—¶åˆ›å»ºã€‚æ ˆç©ºé—´æ˜¯ç”¨æ¥å‚¨å­˜æ ˆå¸§ï¼ˆframesï¼‰çš„ã€‚JVM çš„å †æ ˆç±»ä¼¼äºä¼ ç»Ÿè¯­è¨€ï¼ˆeg. Cï¼‰çš„å †æ ˆï¼šä¿å­˜äº†æœ¬åœ°å˜é‡å’Œéƒ¨åˆ†è¿”å›å€¼ï¼Œå¹¶åœ¨æ–¹æ³•è°ƒç”¨å’Œè¿”å›ä¸­èµ·åˆ°ä½œç”¨ã€‚å› ä¸º JVM æ ˆç©ºé—´é™¤äº†å¼¹å‡º (pop) å’Œå‹å…¥ (push) æ ˆå¸§ä¸ä¼šè¢«ç›´æ¥æ“ä½œï¼Œæ‰€ä»¥æ ˆå¸§å¯èƒ½æ˜¯åœ¨å †ä¸­åˆ†é…çš„ã€‚æ‰€ä»¥ JVM æ ˆçš„å†…å­˜ä¸éœ€è¦æ˜¯è¿ç»­çš„ã€‚</p> <p>ä»¥ä¸Šè§„èŒƒå…è®¸ JVM æ ˆæ‹¥æœ‰å›ºå®šå¤§å°æˆ–è€…æ ¹æ®è®¡ç®—è¦æ±‚åŠ¨æ€æ‰©å±•å’Œæ”¶ç¼©ã€‚å¦‚æœæ ˆæ˜¯å›ºå®šå¤§å°ï¼Œé‚£ä¹ˆåœ¨åˆ›å»ºæ ˆçš„æ—¶å€™å¯ä»¥ç‹¬ç«‹é€‰æ‹©æ ˆçš„å¤§å°ã€‚</p> <blockquote> <p>JVM ç»™ç¨‹åºå‘˜å’Œç”¨æˆ·æä¾›äº†æ§åˆ¶ JVM æ ˆåˆå§‹åŒ–å¤§å°çš„åŠŸèƒ½ï¼Œä»¥åŠåœ¨åŠ¨æ€æ‰©å±•æˆ–æ”¶ç¼©æ ˆç©ºé—´çš„æƒ…å†µä¸‹ï¼ŒæŒ‡å®šæœ€å¤§å’Œæœ€å°å€¼ã€‚</p> </blockquote> <p>ä½†æ˜¯ JVM æ ˆä¹Ÿæœ‰ä¸€äº›ä¾‹å¤–æƒ…å†µï¼ˆå¼‚å¸¸ï¼‰ï¼š</p> <ul> <li> <p>å¦‚æœè¯´è®¡ç®—è¦æ±‚çš„æ ˆç©ºé—´æ¯”å…è®¸ä½¿ç”¨çš„ç©ºé—´è¿˜è¦å¤§ï¼ŒJVM ä¼šæŠ›å‡ºä¸€ä¸ª StackOverflowError å¼‚å¸¸ã€‚</p> </li> <li> <p>å¦‚æœæ ˆç©ºé—´å¯ä»¥åŠ¨æ€æ‰©å±•ï¼Œä½†æ˜¯æ²¡æœ‰è¶³å¤Ÿçš„å†…å­˜ç©ºé—´æ¥å®ç°æ‰©å±•ï¼Œæˆ–è€…æ²¡æœ‰è¶³å¤Ÿçš„å†…å­˜æ¥ä¸ºæ–°çš„çº¿ç¨‹åˆ›å»ºæ ˆç©ºé—´ï¼Œåˆ™ JVM ä¼šæŠ›å‡º<code>OutOfMemoryError</code>ã€‚</p> </li> </ul> <h3 id="heap-">Heap - å †<a class="headerlink" href="#heap-" title="Permanent link">&para;</a></h3> <p>å †åœ¨ JVM ä¸­æ˜¯çº¿ç¨‹å…±äº«çš„ï¼Œæ˜¯ç»™æ‰€æœ‰<strong>ç±»å®ä¾‹</strong>å’Œ<strong>æ•°ç»„</strong>åˆ†é…ç©ºé—´çš„è¿è¡Œæ—¶æ•°æ®åŒºã€‚</p> <p>å †æ˜¯åœ¨ JVM å¯åŠ¨æ—¶åˆ›å»ºçš„ã€‚</p> <p>å­˜å‚¨åœ¨å †ä¸­çš„å¯¹è±¡ç”± <strong>GC</strong>ï¼ˆGarbage Collector, automatic storage management systemï¼‰ å›æ”¶ã€‚æ‰€ä»¥æˆ‘ä»¬åœ¨ Java ä¸­<strong>ä¸ä¼šæ˜¾å¼</strong>é‡Šæ”¾å¯¹è±¡çš„å†…å­˜ã€‚</p> <p>å †å¯ä»¥æ˜¯å›ºå®šå¤§å°æˆ–è€…åŠ¨æ€æ‰©å±•æˆ–è€…å½“å¤§å †æ²¡æœ‰å¿…è¦çš„æ—¶å€™æ”¶ç¼©ã€‚</p> <p>å †çš„å†…å­˜ä¸éœ€è¦è¿ç»­ã€‚</p> <blockquote> <p>JVM ä¹Ÿç»™å¼€å‘è€…æä¾›äº†æ§åˆ¶å †å†…å­˜å¤§å°çš„å‚æ•°</p> <p>-Xms size è®¾å®šå †å†…å­˜æœ€å°å€¼å’Œåˆå§‹å€¼</p> <p>-Xmx size æŒ‡å®šå¯¹å†…å­˜æœ€å¤§å€¼</p> <p>-Xmn size æŒ‡å®šå¯¹å†…å­˜ä¸­å¹´è½»ä»£çš„åˆå§‹å€¼å’Œæœ€å¤§å€¼</p> </blockquote> <p>å¦‚æœç»™å¯¹è±¡åˆ†é…å†…å­˜æ—¶ï¼Œå †å†…å­˜ä¸è¶³äº†ï¼ŒJVM ä¼šæŠ›å‡º<code>OutOfMemoryError</code>ã€‚</p> <p>åœ¨å †ä¸­ï¼Œæˆ‘ä»¬åˆ†å‡ºäº†ä¸¤ä¸ªéƒ¨åˆ†ï¼šnursery (å¯ç§°ä½œå¹´è½»ä»£ - young generation) å’Œ old space (è€å¹´ä»£)ã€‚å…¶ä¸­ nursery memory åˆè¢«æ°›å›´ä¸‰ä¸ªéƒ¨åˆ†ï¼šä¸€ä¸ª Eden memory å’Œä¸¤ä¸ª survivor memory (s0, s1)ã€‚ç»å¤§å¤šæ•°æ–°åˆ›å»ºçš„å¯¹è±¡éƒ½è¢«åˆ†é…åœ¨ Eden Memory ä¸­ï¼Œå½“ Eden Memory æ»¡äº†æ—¶ï¼ŒMinor GC ä¼šå°†æ‰€æœ‰ eden memory ä¸­çš„å¯¹è±¡ç§»åˆ° survivor memory ä¸­ (é€šå¸¸å…¶ä¸­ç”±å¾ˆå¤§ä¸€éƒ¨åˆ†ä¼šè¢«å›æ”¶ï¼Œæœªè¢«å›æ”¶çš„éƒ¨åˆ†ä¼šç§»åˆ° survivor ä¸­)ï¼Œå¹¶ä¸” Minor GC ä¼šæ£€æŸ¥ survivor ä¸­çš„å¯¹è±¡å¹¶å°†å®ƒä»¬ (æœªè¢«å›æ”¶çš„éƒ¨åˆ†) ç§»åˆ°å¦ä¸€ä¸ª survivor memory ä¸­ï¼Œæ‰€ä»¥åœ¨åŒä¸€ä¸ªæ—¶é—´ç‚¹ï¼Œä¼šæœ‰ä¸€ä¸ª survivor memory æ˜¯ç©ºçš„ã€‚å½“å¯¹è±¡åœ¨ survivor ä¸­å­˜æ´»è¶³å¤Ÿå¤šçš„ cycle åï¼Œä¼šè¢«ç§»å…¥ è€å¹´ä»£å†…å­˜ä¸­ã€‚</p> <p><img alt="" src="../images/jvm/jvm-breakdown-2.png"></p> <blockquote> <p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒJava HotSpot VM åœ¨å¯åŠ¨çš„æ—¶å€™ï¼Œä¼šåœ¨åœ°å€ç©ºé—´é¢„ç•™æ•´ä¸ª Heapï¼Œä½†é™¤ééœ€è¦ï¼Œå¦åˆ™ä¸ä¼šä¸ºå…¶åˆ†é…ç‰©ç†å†…å­˜ã€‚</p> </blockquote> <h3 id="method-area-java-8">Method Area - æ–¹æ³•åŒºï¼ˆJava 8 ä¹‹åå·²ç»ç§»é™¤ï¼‰<a class="headerlink" href="#method-area-java-8" title="Permanent link">&para;</a></h3> <p style="color:red">Java 8 ä¹‹åå·²ç»ç§»é™¤äº† Permanent Generationï¼Œæ–¹æ³•åŒºæ˜¯ Java è™šæ‹Ÿæœºçš„é€»è¾‘æ¦‚å¿µã€‚è€Œåœ¨ HotSpot ä¸­ï¼ŒPermanent Generation å°±æ˜¯å®ƒå¯¹è¿™ä¸ªæ¦‚å¿µçš„å®ç°ã€‚</p> <p>å¯¹äºä¸Šé¢çš„ Noteï¼Œå¯ä»¥åœ¨ Oracle çš„å®˜æ–¹æ–‡æ¡£ä¸­æ‰¾åˆ°ç­”æ¡ˆï¼š</p> <details class="note"> <summary>Java Virtual Machine Specification - Chapter 2.5.4</summary> <p>The Java Virtual Machine has a method area that is shared among all Java Virtual Machine threads. The method area is analogous to the storage area for compiled code of a conventional language or analogous to the "text" segment in an operating system process. It stores per-class structures such as the run-time constant pool, field and method data, and the code for methods and constructors, including the special methods (Â§2.9) used in class and instance initialization and interface initialization.</p> <p>The method area is created on virtual machine start-up. <strong>Although the method area is logically part of the heap</strong>, simple implementations may choose not to either garbage collect or compact it. This specification does not mandate the location of the method area or the policies used to manage compiled code. The method area may be of a fixed size or may be expanded as required by the computation and may be contracted if a larger method area becomes unnecessary. The memory for the method area does not need to be contiguous.</p> <p>A Java Virtual Machine implementation may provide the programmer or the user control over the initial size of the method area, as well as, in the case of a varying-size method area, control over the maximum and minimum method area size.</p> <p>The following exceptional condition is associated with the method area:</p> <p>If memory in the method area cannot be made available to satisfy an allocation request, the Java Virtual Machine throws an <code>OutOfMemoryError</code>.</p> </details> <p>ä¸Šé¢ç²—ä½“çš„éƒ¨åˆ†æåˆ°ï¼šâ€œ<strong><em>è™½ç„¶æ–¹æ³•åŒºæ˜¯å †çš„é€»è¾‘éƒ¨åˆ†</em></strong>â€</p> <p>åœ¨ä¸Šæ–¹çš„å¼•ç”¨ä¸­æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°ï¼Œæ–¹æ³•åŒºæ˜¯åœ¨ JVM å¯åŠ¨æ—¶åˆ›å»ºï¼Œå’Œå †ä¸€æ ·ã€‚</p> <p>Permanent Generation æ˜¯åœ¨ Hotspot çš„å¯¹æ–¹æ³•åŒºçš„å®ç°ã€‚</p> <p>æ–¹æ³•åŒºå­˜å‚¨ â€œper-class structureâ€ï¼Œä¾‹å¦‚ï¼š</p> <ol> <li> <p>è¿è¡Œæ—¶å¸¸é‡æ± ï¼ˆrun-time constant poolï¼‰ï¼šInterned Stringsâ€¦</p> </li> <li> <p>field</p> </li> <li> <p>æ–¹æ³•æ•°æ®ï¼ˆmethod dataï¼‰</p> </li> <li> <p>æ–¹æ³•å’Œæ„é€ å™¨çš„ä»£ç ï¼ˆcode for methods and constructorsï¼‰</p> </li> <li> <p>ç”¨åœ¨æ¥å£å’Œå®ä¾‹åˆå§‹åŒ–çš„ç‰¹æ®Šæ–¹æ³•</p> </li> <li> <p>ç±»å…ƒæ•°æ®</p> </li> </ol> <p>ä½†æ˜¯åœ¨ Java 8 åï¼Œç±»å…ƒæ•°æ®è¢«ç§»åˆ°äº†Metaspaceã€‚</p> <h3 id="run-time-constant-pool-">Run-Time Constant Pool - è¿è¡Œæ—¶å¸¸é‡æ± <a class="headerlink" href="#run-time-constant-pool-" title="Permanent link">&para;</a></h3> <p>è¿è¡Œæ—¶å¸¸é‡æ± æ˜¯ç±»æ–‡ä»¶ä¸­å¸¸é‡æ± è¡¨çš„æ¯ä¸ªç±»æˆ–æ¯ä¸ªæ¥å£çš„è¿è¡Œæ—¶è¡¨ç¤ºï¼ŒåŒ…å«äº†ä»ç¼–è¯‘æ—¶å·²çŸ¥çš„æ•°å­—å­—ç¬¦ä¸²åˆ°å¿…é¡»åœ¨è¿è¡Œæ—¶å¤„ç†çš„æ–¹æ³•å’Œå­—æ®µå¼•ç”¨ã€‚</p> <p>å®ƒç±»ä¼¼äºä¼ ç»Ÿç¼–ç¨‹è¯­è¨€ä¸­çš„ç¬¦å·è¡¨ï¼Œåªä¸è¿‡åŒ…å«äº†æ›´å¹¿æ³›çš„æ•°æ®ã€‚</p> <p>åœ¨ Java 8 ä¹‹å‰ï¼Œè¿è¡Œæ—¶å¸¸é‡æ± æ˜¯å­˜åœ¨äºæ–¹æ³•åŒºä¸­çš„ï¼ˆåœ¨ HotSpot è™šæ‹Ÿæœºä¸­ä½äº Permanent Generation ä¸­ï¼‰ï¼Œåœ¨ Java 8 ä¹‹åï¼Œç§»åˆ°äº†å †ä¸­ã€‚</p> <h3 id="native-method-stacks-">Native Method Stacks - æœ¬åœ°æ–¹æ³•æ ˆ<a class="headerlink" href="#native-method-stacks-" title="Permanent link">&para;</a></h3> <p>æœ¬åœ°æ–¹æ³•æ ˆä½¿ JVM èƒ½å¤Ÿä½¿ç”¨ native æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯è¯´ä½¿ç”¨é™¤å¼€ Java ä¹‹å¤–çš„å…¶ä»–è¯­è¨€å¼€å‘çš„æ–¹æ³•ï¼ˆä¾‹å¦‚ï¼šCè¯­è¨€ï¼ŒJVM æ˜¯ C è¯­è¨€å¼€å‘çš„ï¼‰ã€‚</p> <p>é€šå¸¸æ¥è¯´ï¼ŒJVM ä¼šä¸ºæ¯ä¸ªçº¿ç¨‹å•ç‹¬åˆ†é…ä¸€ä¸ªæœ¬åœ°æ–¹æ³•æ ˆï¼Œæ‰€ä»¥æœ¬åœ°æ–¹æ³•æ ˆä¹Ÿæ˜¯çº¿ç¨‹ç§æœ‰çš„ã€‚</p> <p>ä»¥ä¸‹ä¸¤ä¸ªå¼‚å¸¸æ˜¯æœ¬åœ°æ–¹æ³•æ ˆå¯èƒ½ä¼šå‡ºç°çš„ï¼š</p> <ul> <li> <p>StackOverflowErrorï¼šå¦‚æœè®¡ç®—ä¹‹åéœ€è¦çš„å†…å­˜æ¯”è®¾ç½®çš„æœ€å¤§æœ¬åœ°æ–¹æ³•æ ˆè¿˜è¦å¤§ã€‚</p> </li> <li> <p>OutOfMemoryErrorï¼šå †å†…å­˜ä¸è¶³æ—¶ï¼Œæ— æ³•ä¸ºæ–°çš„çº¿ç¨‹åˆ›å»ºåˆå§‹åŒ–çš„æœ¬åœ°æ–¹æ³•æ ˆã€‚</p> </li> </ul> <h3 id="metaspace">Metaspace<a class="headerlink" href="#metaspace" title="Permanent link">&para;</a></h3> <p><a href="#Metaspace---å…ƒç©ºé—´">MetaSpace - å…ƒç©ºé—´</a></p> <h2 id="metaspace-">Metaspace - å…ƒç©ºé—´<a class="headerlink" href="#metaspace-" title="Permanent link">&para;</a></h2> <blockquote> <p>Metaspace æˆ‘ä¸»è¦å‚è€ƒ Thomas StÃ¼fe çš„æ–‡ç« ï¼Œæ ¹æ®è‡ªå·±çš„ç†è§£ï¼Œå°†å…¶ç¿»è¯‘ä¸‹æ¥ã€‚<a href="https://stuefe.de/about/">Thomas StÃ¼fe</a> æ˜¯ OpenJDK çš„å¼€å‘è€…ï¼Œä»–çš„æ–‡ç« åº”è¯¥é è°±ã€‚</p> </blockquote> <p><strong>Reference</strong>: <a href="https://stuefe.de/posts/metaspace/what-is-metaspace/">What is Metaspace</a></p> <p>Metaspace æ˜¯ JVM ç”¨æ¥å­˜æ”¾ç±»å…ƒæ•°æ® (class metadata) çš„åœ°æ–¹ã€‚ç±»å…ƒæ•°æ®æ˜¯åœ¨ JVM è¿›ç¨‹ä¸­ Java ç±»çš„è¿è¡Œæ—¶è¡¨ç¤ºï¼Œç®€å•æ¥è¯´å°±æ˜¯ JVM å¤„ç† Java ç±»æ‰€éœ€è¦çš„æ‰€æœ‰ä¿¡æ¯ã€‚å®ƒåŒ…æ‹¬ä½†ä¸é™äºï¼š</p> <ul> <li> <p>KClass Structure: Java ç±»çš„è¿è¡Œæ—¶çŠ¶æ€çš„è™šæ‹Ÿæœºå†…éƒ¨è¡¨ç¤º (the VM-internal representation of runtime state of a java class)</p> </li> <li> <p>Method Metadata (æ–¹æ³•å…ƒæ•°æ®) - æ–¹æ³•çš„ç›¸å…³ä¿¡æ¯æ•°æ®ï¼ŒåŒ…æ‹¬å­—èŠ‚ç  (bytecode)ï¼Œå¼‚å¸¸è¡¨ (exception table)ï¼Œå¸¸é‡ (constant)ï¼Œå±€éƒ¨å˜é‡è¡¨ (local variables table)ï¼Œå‚æ•°ä¿¡æ¯ç­‰â€¦</p> </li> <li> <p>å¸¸é‡æ± </p> </li> <li> <p>æ³¨è§£</p> </li> <li> <p>æ–¹æ³•è®¡æ•°å™¨æ”¶é›†æ–¹æ³•è°ƒç”¨æ¬¡æ•°ï¼Œç”¨æ¥è¾…åŠ© JIT å†³ç­–</p> </li> <li> <p>...</p> </li> </ul> <h2 id="frames-">Frames - æ ˆå¸§<a class="headerlink" href="#frames-" title="Permanent link">&para;</a></h2> <blockquote> <p>ä¸»è¦è¯¦ç»†è¯´æ˜ä¸Šæ–‡è¯´åˆ°çš„æ ˆå¸§ã€‚</p> </blockquote> <p>æ ˆå¸§æ˜¯ç”¨æ¥å‚¨å­˜æ•°æ®å’Œéƒ¨åˆ†ç»“æœï¼Œæ‰§è¡ŒåŠ¨æ€é“¾æ¥ï¼Œè¿”å›å€¼ï¼Œä»¥åŠæŠ›å‡ºå¼‚å¸¸ã€‚</p> <p>æ–°çš„æ ˆå¸§æ˜¯åœ¨æ¯æ¬¡æ–¹æ³•è¢«è°ƒç”¨æ—¶åˆ›å»ºï¼Œå¹¶éšç€æ–¹æ³•è°ƒç”¨å®Œæˆé”€æ¯ï¼ˆä¸ç®¡æ˜¯å¦æ­£å¸¸ç»“æŸæˆ–æŠ›å‡ºäº†å¼‚å¸¸ï¼‰ã€‚æ ˆå¸§æ˜¯è¢«çº¿ç¨‹åˆ›å»ºä¸”åˆ†é…åœ¨JVMæ ˆä¸­ã€‚æ¯ä¸ªæ ˆå¸§éƒ½æœ‰è‡ªå·±çš„æœ¬åœ°å˜é‡æ•°ç»„ï¼Œæ“ä½œæ•°æ ˆä»¥åŠä¸€ä¸ªå½“å‰æ–¹æ³•çš„ç±»çš„è¿è¡Œæ—¶å¸¸é‡æ± çš„å¼•ç”¨ã€‚</p> <p><strong>å½“ä¸€ä¸ªæ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œä¸€ä¸ªæ ˆå¸§ä¼šè¢«å‹å…¥JVMæ ˆä¸­ï¼Œè¯¥æ ˆå¸§è¢«ç§°ä¸ºå½“å‰æ ˆï¼Œè€Œå…¶åŠç”¨çš„æ–¹æ³•æ˜¯å½“å‰æ–¹æ³•ã€‚å¦‚æœè¯¥æ ˆå¸§è°ƒç”¨äº†å¦ä¸€ä¸ªæ–¹æ³•ï¼Œåˆ™è¯¥æ ˆå¸§å°†ä¸æ˜¯å½“å‰æ ˆå¸§ï¼Œä¸€ä¸ªæ–°çš„æ ˆå¸§ä¼šè¢«å‹å…¥JVMæ ˆï¼Œå½“æ–°çš„æ–¹æ³•è°ƒç”¨å®Œæˆåï¼Œå½“å‰æ ˆå¸§ä¼šè¢«å¼¹å‡ºJVMæ ˆï¼Œä¸Šä¸€ä¸ªæ ˆå¸§åˆ™å˜æˆå½“å‰æ ˆå¸§äº†ã€‚</strong></p> <h3 id="local-variables-">Local Variables - æœ¬åœ°å˜é‡<a class="headerlink" href="#local-variables-" title="Permanent link">&para;</a></h3> <p>æ¯ä¸ªæ ˆå¸§éƒ½å«æœ‰ä¸€ä¸ªè¢«ç§°ä¸ºæœ¬åœ°å˜é‡ï¼ˆlocal variablesï¼‰çš„å˜é‡æ•°ç»„ã€‚</p> <p>å•ä¸ªå±€éƒ¨å˜é‡èƒ½ä¿å­˜ boolean, byte, char, short, int, float, reference æˆ– returnAddress çš„å€¼ã€‚ä¸€å¯¹å±€éƒ¨å˜é‡æ‰èƒ½ä¿å­˜ long æˆ– double çš„å€¼ï¼ˆlongæˆ–doubleéœ€è¦å ç”¨ä¸¤ä¸ªè¿ç»­åœ°å€çš„å±€éƒ¨å˜é‡ï¼‰ã€‚</p> <p>ç±»æ–¹æ³•è°ƒç”¨æ—¶ï¼Œä»»ä½•è¢«ä¼ å…¥çš„å‚æ•°çš„ç´¢å¼•éƒ½æ˜¯ä» 0 å¼€å§‹çš„ã€‚è€Œåœ¨å®ä¾‹æ–¹æ³•è°ƒç”¨æ—¶ï¼Œç´¢å¼•ä¸º 0 çš„å±€éƒ¨å˜é‡æ˜¯è¿™ä¸ªå®ä¾‹æ–¹æ³•è¢«è°ƒç”¨çš„å¯¹è±¡çš„å¼•ç”¨ï¼ˆthisï¼‰ï¼Œæ‰€æœ‰å‚æ•°çš„ç´¢å¼•éƒ½æ˜¯ä» 1 å¼€å§‹ã€‚</p> <h3 id="operand-stacks-">Operand Stacks - æ“ä½œæ•°æ ˆ<a class="headerlink" href="#operand-stacks-" title="Permanent link">&para;</a></h3> <p>æ¯ä¸€ä¸ªæ ˆå¸§éƒ½å«æœ‰ä¸€ä¸ªåè¿›å…ˆå‡º(LIFO)çš„æ ˆï¼Œå«åš operand stack (æ“ä½œæ•°æ ˆ)ã€‚</p> <p>æ ˆå¸§åˆ›å»ºçš„æ—¶å€™æ“ä½œæ•°æ ˆæ˜¯ç©ºçš„ï¼ŒJVM ä¼šé€šè¿‡ä¸€äº›æŒ‡ä»¤æ¥åŠ è½½å¸¸é‡æˆ–è€…å±€éƒ¨å˜é‡çš„å€¼æˆ–å­—æ®µåˆ°æ“ä½œæ•°æ ˆã€‚å…¶ä»–ä¸€äº› JVM æŒ‡ä»¤ä¼šä»æ“ä½œæ•°æ ˆä¸­å–å‡ºæ“ä½œæ•°ï¼Œæ ¹æ®æŒ‡ä»¤æ“ä½œå®ƒä»¬ï¼Œå¹¶å°†ç»“æœå†å‹å…¥æ“ä½œæ•°æ ˆã€‚æ“ä½œæ•°æ ˆä¹Ÿä¼šè¢«ç”¨æ¥å‡†å¤‡ä¼ å…¥æ–¹æ³•çš„å‚æ•°å’Œæ¥æ”¶æ–¹æ³•è¿”å›ç»“æœã€‚</p> <p>ä¸¾ä¸ªğŸŒ°ï¼š</p> <p>JVM ä½¿ç”¨ iadd (<a href="https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-6.html#jvms-6.5.iadd">"iadd" Instruction</a>) æŒ‡ä»¤å°†ä¸¤ä¸ª int æ•°å­—åŠ åœ¨ä¸€èµ·ï¼ŒJVMä¼šè¦æ±‚è¿™ä¸¤ä¸ªéœ€è¦è¢«åŠ åœ¨ä¸€èµ·çš„æ•´å‹æ•°å­—è¦åœ¨æ“ä½œæ•°æ ˆçš„æœ€é¡¶ç«¯ï¼Œå‰ä¸€ä¸ªæŒ‡ä»¤ä¼šå°†å®ƒä»¬ä¸¤ä¸ªå‹å…¥æ ˆä¸­ã€‚ç„¶åï¼Œå®ƒä»¬ä¸¤ä¸ªä¼šä»æ“ä½œæ•°æ ˆä¸­è¢«å¼¹å‡ºï¼Œç›¸åŠ ä¹‹åçš„ç»“æœä¼šè¢«å‹å…¥æ“ä½œæ•°æ ˆä¸­ã€‚</p> <div class="admonition warning"> <p class="admonition-title">Warning</p> <p>å¿…é¡»ä»¥é€‚åˆå…¶ç±»å‹çš„æ“ä½œæ–¹å¼æ“ä½œ operand stack ä¸­çš„å€¼ã€‚</p> </div> <p>åœ¨ä»»ä½•æ—¶å€™ï¼Œæ“ä½œæ•°æ ˆéƒ½æœ‰ä¸€ä¸ªå…³è”æ·±åº¦ï¼Œå…¶ä¸­ long å’Œ double ç±»å‹çš„å€¼è´¡çŒ®ä¸¤ä¸ªå•ä½çš„æ·±åº¦ï¼Œè€Œå…¶å®ƒç±»å‹çš„å€¼è´¡çŒ®ä¸€ä¸ªå•ä½çš„æ·±åº¦ã€‚</p> <h3 id="dynamic-linking-">Dynamic Linking - åŠ¨æ€é“¾æ¥<a class="headerlink" href="#dynamic-linking-" title="Permanent link">&para;</a></h3> <p>æ¯ä¸ªæ ˆå¸§éƒ½åŒ…å«å¯¹å½“å‰æ–¹æ³•ç±»å‹çš„è¿è¡Œæ—¶å¸¸é‡æ± çš„å¼•ç”¨ï¼Œä»¥æ”¯æŒæ–¹æ³•ä»£ç çš„åŠ¨æ€é“¾æ¥ã€‚</p> <p>æ–¹æ³•çš„ class file code é€šè¿‡ç¬¦å·å¼•ç”¨ (symbolic reference) æŒ‡å‘è¢«è°ƒç”¨çš„æ–¹æ³•å’Œè¢«è®¿é—®çš„å‚æ•°ã€‚åŠ¨æ€é“¾æ¥å°±æ˜¯å°†è¿™äº›ç¬¦å·å¼•ç”¨è½¬æ¢æˆå…·ä½“çš„æ–¹æ³•å¼•ç”¨ï¼Œå¹¶ä¸”å°†å‚æ•°è®¿é—®è½¬æ¢æˆä¸è¿™äº›å‚æ•°ç›¸å…³è”çš„å­˜å‚¨ç»“æ„çš„ä½ç§»ã€‚</p> <h2 id="conclusion">Conclusion<a class="headerlink" href="#conclusion" title="Permanent link">&para;</a></h2> <p>Java çš„å†…å­˜åŒºåŸŸæœ‰ä»¥ä¸‹å‡ ä¸ªï¼š</p> <ol> <li> <p>Heap</p> </li> <li> <p>JVM Stack</p> </li> <li> <p>Method Area ï¼ˆHotSpotä¸­çš„å®ç°ä¸º Permanent Generationï¼‰</p> </li> <li> <p>Metaspace</p> </li> </ol> <p>å…¶ä¸­ <strong>JVM Stack</strong> ä¸­å­˜å‚¨ï¼š</p> <ol> <li> <p>PC Register</p> </li> <li> <p>Native Method Stack</p> </li> <li> <p>Frames - æ ˆå¸§ a. å±€éƒ¨å˜é‡æ•°ç»„ b. æ“ä½œæ•°æ ˆ c. åŠ¨æ€é“¾æ¥</p> </li> </ol> <p>Heap ä¸­å­˜æ”¾ï¼š</p> <ol> <li> <p>ç±»å®ä¾‹å’Œæ•°ç»„</p> </li> <li> <p>Run-Time Constant Pool</p> </li> <li> <p>Interned Strings</p> </li> <li> <p>Class Statics</p> </li> </ol> <p>Metaspaceä¸­å­˜æ”¾ï¼š</p> <p>ç±»å…ƒæ•°æ®ï¼šåŒ…æ‹¬ä½†ä¸é™äºKClassç»“æ„ï¼ˆå¾ˆé‡è¦ï¼Œå¯ä»¥ç†è§£ä¸ºJavaç±»åœ¨è™šæ‹Ÿæœºå†…éƒ¨çš„è¡¨ç¤ºï¼‰ã€æ–¹æ³•å…ƒæ•°æ®ï¼ˆåŒ…æ‹¬å­—èŠ‚ç ï¼Œæ–¹æ³•å‚æ•°ä¿¡æ¯ï¼‰ã€å¸¸é‡æ± ã€æ³¨è§£ã€æ–¹æ³•è®¡æ•°å™¨ã€‚ã€‚ã€‚</p> <h2 id="__comments">è¯„è®º</h2> <div id="disqus_thread"></div> <script>var disqus_config=function(){this.page.url="https://yongqilei.github.io/java/jvm-breakdown/",this.page.identifier="java/jvm-breakdown/"};if("undefined"==typeof DISQUS){var script=document.createElement("script");script.async=!0,script.src="https://programming-tech-sharing.disqus.com/embed.js",script.setAttribute("data-timestamp",Date.now()),document.body.appendChild(script)}else DISQUS.reset({reload:!0,config:disqus_config})</script> </article> </div> </div> <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg> å›åˆ°é¡µé¢é¡¶éƒ¨ </a> </main> <footer class="md-footer"> <nav class="md-footer__inner md-grid" aria-label="é¡µè„š"> <a href="../garbage-collector/" class="md-footer__link md-footer__link--prev" aria-label="ä¸Šä¸€é¡µ: Java åƒåœ¾æ”¶é›†å™¨" rel="prev"> <div class="md-footer__button md-icon"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class="md-footer__title"> <div class="md-ellipsis"> <span class="md-footer__direction"> ä¸Šä¸€é¡µ </span> Java åƒåœ¾æ”¶é›†å™¨ </div> </div> </a> <a href="../spring-cloud-ribbon/" class="md-footer__link md-footer__link--next" aria-label="ä¸‹ä¸€é¡µ: Spring Cloud Ribbon" rel="next"> <div class="md-footer__title"> <div class="md-ellipsis"> <span class="md-footer__direction"> ä¸‹ä¸€é¡µ </span> Spring Cloud Ribbon </div> </div> <div class="md-footer__button md-icon"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class="md-copyright"> <div class="md-copyright__highlight"> Copyright &copy; 2021 - 2022 Eng Learning by Torres </div> Made with <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener"> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class="md-dialog" data-md-component="dialog"> <div class="md-dialog__inner md-typeset"></div> </div> <script id="__config" type="application/json">{"base": "../..", "features": ["search.suggest", "search.highlight", "search.share", "navigation.tabs", "navigation.instant", "navigation.tracking", "navigation.top", "content.tabs.link"], "search": "../../assets/javascripts/workers/search.361d90f1.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.config.lang": "ja", "search.config.pipeline": "trimmer, stemmer", "search.config.separator": "[\\uff0c\\u3002]+", "search.placeholder": "\u641c\u7d22", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version.title": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script> <script src="../../assets/javascripts/bundle.289a2a4b.min.js"></script> <script src="../../javascripts/mathjax.js"></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script> 